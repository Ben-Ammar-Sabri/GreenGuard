<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenGuard - Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-dark: #faedca;
            --card-bg: #c1dbb3;
            --accent: #7ebc89;
            --primary: #1e4d2b;
            --text-main: #1a3c26;
            --text-muted: #3d5a45;
            --success: #27ae60;
            --danger: #c0392b;
            --warning: #e4910b;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            color: var(--primary);
            text-shadow: 0 0 10px rgba(46, 204, 113, 0.3);
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            position: relative;
        }

        .metric-value {
            font-size: 3.5rem;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
            color: var(--text-main);
        }

        .metric-unit {
            font-size: 1.2rem;
            color: var(--text-muted);
        }

        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .status-item {
            padding: 12px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            border: 1px solid transparent;
        }

        .active {
            background: rgba(0, 184, 148, 0.15);
            border: 2px solid var(--success);
            color: var(--success);
            box-shadow: 0 4px 10px rgba(0, 184, 148, 0.2);
        }

        .inactive {
            background: #f1f2f6;
            border: 1px solid #dfe4ea;
            color: #a4b0be;
        }

        .motion-active {
            background: rgba(231, 76, 60, 0.15);
            border: 2px solid var(--danger);
            color: var(--danger);
            box-shadow: 0 4px 10px rgba(231, 76, 60, 0.3);
            animation: pulse-motion 1s infinite;
        }

        @keyframes pulse-motion {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.02);
            }

            100% {
                transform: scale(1);
            }
        }

        .info-badge {
            font-size: 0.9rem;
            color: #e8f5e9;
            background: #3d5a45;
            padding: 10px 20px;
            border-radius: 50px;
            display: inline-block;
            margin: 10px 0 20px 0;
            line-height: 1.5;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #2d4030;
        }

        .info-badge span {
            font-weight: 800;
            color: #a3e4d7;
            font-size: 1.0rem;
        }

        .info-badge i {
            color: #a3e4d7;
            margin-right: 8px;
        }

        .metric-wrapper {
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 5px;
        }

        /* Sidebar */
        .sidebar {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1000;
            top: 0;
            right: 0;
            background-color: #a9dfbf;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
        }

        .sidebar-content {
            padding: 20px;
            color: var(--text-main);
            width: 300px;
        }

        .sidebar h2 {
            color: var(--primary);
            margin-bottom: 30px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
        }

        .config-group {
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.4);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .config-group small {
            font-family: 'Segoe UI', sans-serif;
            font-weight: 700;
            color: #145a32;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .setting-label {
            font-weight: bold;
            color: #0b5345;
            font-size: 1rem;
        }

        .setting-input {
            background: transparent;
            border: 1px solid var(--text-muted);
            color: var(--text-main);
            padding: 5px;
            width: 60px;
            border-radius: 5px;
            text-align: center;
            font-size: 1rem;
        }

        .closebtn {
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 36px;
            color: #bdc3c7;
            text-decoration: none;
            cursor: pointer;
        }

        .closebtn:hover {
            color: var(--primary);
        }

        .config-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
            z-index: 999;
            transition: transform 0.3s;
        }

        .config-btn:hover {
            transform: rotate(90deg);
        }

        #cnx-status {
            font-weight: bold;
        }

        /* Time Simulation Buttons */
        .btn-time {
            opacity: 0.5;
            transition: all 0.3s;
            border: 2px solid transparent;
            filter: grayscale(0.6);
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }

        .btn-time:hover {
            opacity: 0.8;
            filter: grayscale(0);
        }

        .btn-time.active {
            opacity: 1;
            transform: scale(1.05);
            border-color: #fff;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            filter: grayscale(0);
            font-weight: bold;
        }

        @keyframes flash {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <div>
                <h1><i class="fas fa-leaf"></i> GreenGuard</h1>
                <div class="subtitle">Serre Autonome ConnectÃ©e</div>
            </div>
            <div style="display:flex; align-items:center; gap:15px;">
                <button id="btn-simulate" class="btn-time" style="background:#9b59b6; color:#fff; padding:10px 20px;"
                    onclick="toggleSimulation()">
                    <i class="fas fa-magic"></i> Simuler
                </button>
                <div id="cnx-status" style="color:red">ðŸ”´ DÃ‰CONNECTÃ‰</div>
            </div>
        </header>

        <!-- Temperature Card -->
        <div class="card">
            <h3><i class="fas fa-thermometer-half"></i> TempÃ©rature</h3>
            <div class="metric-wrapper">
                <span id="val-temp" class="metric-value">--</span>
                <span class="metric-unit">Â°C</span>
            </div>

            <div class="info-badge">
                <i class="fas fa-info-circle"></i>
                Chauffage si < <span id="lbl-min-t">18</span>Â°C <br>
                    Ventilo si > <span id="lbl-max-t">28</span>Â°C
            </div>

            <div class="status-grid">
                <div id="st-heat" class="status-item inactive"><i class="fas fa-fire"></i> Chauffage</div>
                <div id="st-fan" class="status-item inactive"><i class="fas fa-wind"></i> Ventilo</div>
            </div>
        </div>

        <!-- Humidity Card -->
        <div class="card">
            <h3><i class="fas fa-tint"></i> HumiditÃ© Sol</h3>
            <div class="metric-wrapper">
                <span id="val-hum" class="metric-value">--</span>
                <span class="metric-unit">%</span>
            </div>

            <div class="info-badge">
                <i class="fas fa-info-circle"></i>
                Arrosage si < <span id="lbl-min-h">40</span>%
            </div>

            <div class="status-grid">
                <div id="st-pump" class="status-item inactive" style="grid-column: 1 / -1">
                    <i class="fas fa-faucet"></i> Pompe Arrosage
                </div>
            </div>
        </div>

        <!-- Light & Security Card -->
        <div class="card">
            <h3><i class="fas fa-sun"></i> LuminositÃ© & SÃ©curitÃ©</h3>
            <div class="metric-wrapper">
                <span id="val-lux" class="metric-value">--</span>
                <span class="metric-unit">Lux</span>
            </div>

            <!-- Time Display -->
            <div id="time-display"
                style="font-size: 1.2rem; margin-bottom: 15px; color: var(--text-main); font-weight:bold; margin-top: 15px;">
                <i class="far fa-clock"></i> <span id="val-time">--:--</span>
                <span id="val-daynight"
                    style="font-size: 0.8rem; background: #333; padding: 4px 8px; border-radius: 6px; margin-left: 10px; vertical-align: middle;">--</span>
            </div>

            <!-- Time Demo Controls -->
            <div style="display:flex; justify-content:center; gap:10px; margin-bottom:10px;">
                <button id="btn-sim-day" class="btn-time" style="background:#f39c12; color:#fff;"
                    onclick="setTimeDemo(12)">
                    <i class="fas fa-sun"></i> Jour (12h)
                </button>
                <button id="btn-sim-night" class="btn-time" style="background:#34495e; color:#fff;"
                    onclick="setTimeDemo(23)">
                    <i class="fas fa-moon"></i> Nuit (23h)
                </button>
                <button id="btn-sim-auto" class="btn-time active" style="background:#27ae60; color:#fff;"
                    onclick="setRealTime()">
                    <i class="fas fa-clock"></i> Auto
                </button>
            </div>

            <!-- INTRUSION ALERT (Hidden by default) -->
            <div id="alert-box"
                style="display:none; background: #c0392b; color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; animation: flash 0.5s infinite;">
                <i class="fas fa-exclamation-triangle"></i> <strong>ALERTE INTRUSION !</strong><br>
                Mouvement dÃ©tectÃ© !
            </div>
            <audio id="alarm-sound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"
                preload="auto"></audio>

            <div class="info-badge">
                <i class="fas fa-regular fa-lightbulb"></i>
                Allumage si < <span id="lbl-min-l">500</span> Lux
            </div>

            <div class="status-grid">
                <div id="st-light" class="status-item inactive">
                    <i class="fas fa-lightbulb"></i> Lampes UV
                </div>
                <div id="st-motion" class="status-item inactive">
                    <i class="fas fa-walking"></i> Mouvement
                </div>
            </div>
        </div>

        <!-- Charts Grid -->
        <div
            style="grid-column: 1 / -1; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <div class="card">
                <canvas id="tempChart" height="150"></canvas>
            </div>
            <div class="card">
                <canvas id="humChart" height="150"></canvas>
            </div>
            <div class="card">
                <canvas id="luxChart" height="150"></canvas>
            </div>
        </div>
    </div>

    <!-- Config Trigger Button -->
    <button class="config-btn" onclick="openConfig()"><i class="fas fa-sliders-h"></i></button>

    <!-- Sidebar -->
    <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="closebtn" onclick="closeConfig()">&times;</a>
        <div class="sidebar-content">
            <h2><i class="fas fa-cogs"></i> Configuration</h2>

            <div class="config-group">
                <label class="setting-label"><i class="fas fa-thermometer-half"></i> TempÃ©rature (Â°C)</label>
                <div style="display:flex; justify-content:space-between; margin-top:10px">
                    <div>
                        <small>Min (Chauffage)</small><br>
                        <input type="number" class="setting-input" id="set-min-t" value="18.0" step="0.5"
                            onchange="pushSettings()">
                    </div>
                    <div>
                        <small>Max (Ventilo)</small><br>
                        <input type="number" class="setting-input" id="set-max-t" value="28.0" step="0.5"
                            onchange="pushSettings()">
                    </div>
                </div>
            </div>

            <div class="config-group">
                <label class="setting-label"><i class="fas fa-tint"></i> HumiditÃ© Sol (%)</label>
                <div style="margin-top:10px">
                    <small>Min (Arrosage)</small><br>
                    <input type="number" class="setting-input" id="set-min-h" value="40" step="1"
                        onchange="pushSettings()">
                </div>
            </div>

            <div class="config-group">
                <label class="setting-label"><i class="fas fa-sun"></i> LuminositÃ© (Lux)</label>
                <div style="margin-top:10px">
                    <small>Seuil Allumage <br>
                        <input type="number" class="setting-input" id="set-min-l" value="500" step="50"
                            onchange="pushSettings()">
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- MQTT ---
        const broker = "broker.emqx.io";
        const port = 8084; // WebSocket Secure Port (EMQX)
        const topicData = "greenguard/data";
        const topicControl = "greenguard/control";
        const topicSettings = "greenguard/settings";
        const topicAlarm = "greenguard/alarm";

        let client = new Paho.MQTT.Client(broker, port, "web_gg_" + Math.random().toString(16).substr(2));

        // --- State ---
        let currentServerTime = null;

        setInterval(() => {
            if (currentServerTime) {
                currentServerTime.setSeconds(currentServerTime.getSeconds() + 1);
                // Update Display
                const h = String(currentServerTime.getHours()).padStart(2, '0');
                const m = String(currentServerTime.getMinutes()).padStart(2, '0');
                const s = String(currentServerTime.getSeconds()).padStart(2, '0');
                document.getElementById("val-time").innerText = `${h}:${m}:${s}`;
            }
        }, 1000);

        // --- Charts ---
        Chart.defaults.color = '#636e72';
        Chart.defaults.borderColor = 'rgba(0, 0, 0, 0.05)';

        const createGradient = (ctx, color) => {
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, color.replace('1)', '0.4)'));
            gradient.addColorStop(1, color.replace('1)', '0.0)'));
            return gradient;
        };

        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 800 },
            interaction: { mode: 'index', intersect: false },
            scales: {
                y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' } },
                x: { display: false }
            },
            plugins: { legend: { display: false } },
            elements: {
                point: { radius: 2, hoverRadius: 5 },
                line: { tension: 0.3, borderWidth: 3 }
            }
        };

        // Load Data from LocalStorage
        const loadChartData = (key) => {
            const saved = localStorage.getItem(key);
            return saved ? JSON.parse(saved) : [];
        };

        const saveChartData = (key, data) => {
            localStorage.setItem(key, JSON.stringify(data));
        };

        // Temp Chart
        const ctxT = document.getElementById('tempChart').getContext('2d');
        const tempChart = new Chart(ctxT, {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    label: 'Temp Â°C',
                    data: loadChartData('gg_temp'),
                    borderColor: '#c0392b',
                    backgroundColor: createGradient(ctxT, 'rgba(192, 57, 43, 1)'),
                    fill: true
                }]
            },
            options: { ...commonOptions, plugins: { title: { display: true, text: 'TempÃ©rature (Â°C)', color: '#1e4d2b' } } }
        });

        // Hum Chart
        const ctxH = document.getElementById('humChart').getContext('2d');
        const humChart = new Chart(ctxH, {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    label: 'Hum %',
                    data: loadChartData('gg_hum'),
                    borderColor: '#2980b9',
                    backgroundColor: createGradient(ctxH, 'rgba(41, 128, 185, 1)'),
                    fill: true
                }]
            },
            options: { ...commonOptions, plugins: { title: { display: true, text: 'HumiditÃ© (%)', color: '#1e4d2b' } } }
        });

        // Lux Chart
        const ctxL = document.getElementById('luxChart').getContext('2d');
        const luxChart = new Chart(ctxL, {
            type: 'line',
            data: {
                labels: Array(20).fill(''),
                datasets: [{
                    label: 'Lux',
                    data: loadChartData('gg_lux'),
                    borderColor: '#d35400',
                    backgroundColor: createGradient(ctxL, 'rgba(211, 84, 0, 1)'),
                    fill: true
                }]
            },
            options: { ...commonOptions, plugins: { title: { display: true, text: 'LuminositÃ© (Lux)', color: '#1e4d2b' } } }
        });

        // --- Logic ---
        function connect() {
            client.connect({ onSuccess: onConnect, useSSL: true, onFailure: () => setTimeout(connect, 3000) });
        }

        function onConnect() {
            document.getElementById("cnx-status").innerHTML = "ðŸŸ¢ CONNECTÃ‰";
            document.getElementById("cnx-status").style.color = "#2ecc71";
            client.subscribe(topicData);
            client.subscribe(topicAlarm);
        }

        client.onConnectionLost = (resp) => {
            document.getElementById("cnx-status").innerHTML = "ðŸ”´ DÃ‰CONNECTÃ‰";
            document.getElementById("cnx-status").style.color = "red";
            setTimeout(connect, 3000);
        };

        client.onMessageArrived = (msg) => {
            console.log("MQTT Recv: " + msg.payloadString);

            // Handle Alarm Topic
            if (msg.destinationName === topicAlarm) {
                const alarmState = msg.payloadString;
                const alertBox = document.getElementById("alert-box");
                const audio = document.getElementById("alarm-sound");

                if (alarmState === "ON") {
                    alertBox.style.display = "block";
                    audio.play().catch(e => console.log("Audio play failed (user interaction needed first):", e));
                } else {
                    alertBox.style.display = "none";
                    audio.pause();
                    audio.currentTime = 0;
                }
                return;
            }

            if (msg.destinationName === topicData) {
                const data = JSON.parse(msg.payloadString);
                updateUI(data);
            }
        };

        function updateUI(data) {
            // Update Values
            document.getElementById("val-temp").innerText = data.temp.toFixed(1);
            document.getElementById("val-hum").innerText = data.hum.toFixed(0);
            document.getElementById("val-lux").innerText = data.lux;

            // Status
            setClass("st-heat", data.heat);
            setClass("st-fan", data.fan);
            setClass("st-pump", data.pump);
            setClass("st-light", data.light);

            // Motion Status (special styling)
            setMotionClass("st-motion", data.motion);

            // Update Charts
            function updateChartData(chart, val, key) {
                if (chart.data.datasets[0].data.length > 20) chart.data.datasets[0].data.shift();
                chart.data.datasets[0].data.push(val);
                chart.update();
                saveChartData(key, chart.data.datasets[0].data);
            }
            updateChartData(tempChart, data.temp, 'gg_temp');
            updateChartData(humChart, data.hum, 'gg_hum');
            updateChartData(luxChart, data.lux, 'gg_lux');

            // Time & Day/Night
            if (data.time && data.time !== "--:--:--") {
                const parts = data.time.split(':');
                const now = new Date();
                now.setHours(parseInt(parts[0]));
                now.setMinutes(parseInt(parts[1]));
                now.setSeconds(parseInt(parts[2]));
                currentServerTime = now;

                document.getElementById("val-time").innerText = data.time;
            }

            const dnSpan = document.getElementById("val-daynight");
            if (data.isNight) {
                dnSpan.innerText = "NUIT";
                dnSpan.style.background = "#2c3e50";
                dnSpan.style.color = "#ecf0f1";
                dnSpan.innerHTML = '<i class="fas fa-moon"></i> NUIT';
            } else {
                dnSpan.innerText = "JOUR";
                dnSpan.style.background = "#f1c40f";
                dnSpan.style.color = "#2c3e50";
                dnSpan.innerHTML = '<i class="fas fa-sun"></i> JOUR';
            }
        }

        function setClass(id, isActive) {
            const el = document.getElementById(id);
            if (isActive) {
                el.classList.remove("inactive");
                el.classList.add("active");
            } else {
                el.classList.remove("active");
                el.classList.add("inactive");
            }
        }

        function setMotionClass(id, isActive) {
            const el = document.getElementById(id);
            el.classList.remove("inactive", "active", "motion-active");
            if (isActive) {
                el.classList.add("motion-active");
            } else {
                el.classList.add("inactive");
            }
        }

        // --- Time Demo Functions ---
        function setTimeDemo(hour) {
            // 1. Activate Time Demo Mode
            let msgMode = new Paho.MQTT.Message("TIME_DEMO_ON");
            msgMode.destinationName = topicControl;
            client.send(msgMode);

            // 2. Set Hour
            let msgHour = new Paho.MQTT.Message("SET_HOUR:" + hour);
            msgHour.destinationName = topicControl;
            client.send(msgHour);

            console.log("ðŸ•’ Time Demo set to:", hour + "h");

            // UI Feedback
            updateTimeButtons(hour === 12 ? 'day' : 'night');
        }

        function setRealTime() {
            let msgMode = new Paho.MQTT.Message("TIME_DEMO_OFF");
            msgMode.destinationName = topicControl;
            client.send(msgMode);

            console.log("ðŸ•’ Back to Real Time");
            updateTimeButtons('auto');
        }

        function updateTimeButtons(mode) {
            document.getElementById("btn-sim-day").classList.remove("active");
            document.getElementById("btn-sim-night").classList.remove("active");
            document.getElementById("btn-sim-auto").classList.remove("active");

            if (mode === 'day') document.getElementById("btn-sim-day").classList.add("active");
            if (mode === 'night') document.getElementById("btn-sim-night").classList.add("active");
            if (mode === 'auto') document.getElementById("btn-sim-auto").classList.add("active");
        }

        let simulationActive = false;

        function toggleSimulation() {
            simulationActive = !simulationActive;
            const btn = document.getElementById("btn-simulate");

            if (simulationActive) {
                let msg = new Paho.MQTT.Message("SIM_ON");
                msg.destinationName = topicControl;
                client.send(msg);
                btn.classList.add("active");
                btn.innerHTML = '<i class="fas fa-magic"></i> Simulation ON';
                console.log("âœ¨ Simulation Mode ON");
            } else {
                let msg = new Paho.MQTT.Message("SIM_OFF");
                msg.destinationName = topicControl;
                client.send(msg);
                btn.classList.remove("active");
                btn.innerHTML = '<i class="fas fa-magic"></i> Simuler Effets';
                console.log("âœ¨ Simulation Mode OFF");
            }
        }

        // --- Sidebar Logic ---
        function openConfig() {
            document.getElementById("mySidebar").style.width = "350px";
        }

        function closeConfig() {
            document.getElementById("mySidebar").style.width = "0";
        }

        // --- Settings ---
        let debounceTimer = null;

        function pushSettings() {
            if (debounceTimer) clearTimeout(debounceTimer);

            const minT = parseFloat(document.getElementById("set-min-t").value);
            const maxT = parseFloat(document.getElementById("set-max-t").value);
            const minH = parseFloat(document.getElementById("set-min-h").value);
            const minL = parseFloat(document.getElementById("set-min-l").value);

            // Update Badges Visuals Immediately
            document.getElementById("lbl-min-t").innerText = minT;
            document.getElementById("lbl-max-t").innerText = maxT;
            document.getElementById("lbl-min-h").innerText = minH;
            document.getElementById("lbl-min-l").innerText = minL;

            debounceTimer = setTimeout(() => {
                const payload = JSON.stringify({ "min_t": minT, "max_t": maxT, "min_h": minH, "min_l": minL });
                let message = new Paho.MQTT.Message(payload);
                message.destinationName = topicSettings;
                client.send(message);
                console.log("ðŸ“¨ SENT:", payload);
            }, 1000);
        }

        // Init
        connect();

    </script>
</body>

</html>